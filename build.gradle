buildscript {
    repositories {
        mavenCentral()
        mavenLocal()
    }

    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:5.0.0'
    }
}

plugins {
    id 'java'
}

subprojects { p ->
    apply plugin: 'java'
    apply plugin: 'com.github.johnrengelman.shadow'

    group 'fr.pearl.core'
    version '1.0-SNAPSHOT'

    compileJava.options.encoding = 'UTF-8'

    repositories {
        mavenCentral()
        mavenLocal()

        flatDir {
            dir "lib"
        }
    }

    dependencies {
        if (p.name != 'api') {
            implementation project(':api')
            if (p.name == 'bungee') {
                compileOnly name: 'bungee'
            } else if (p.name == 'spigot') {
                compileOnly 'io.netty:netty-all:4.1.63.Final'
            } else if (p.name != 'all'){
                implementation project(':spigot')
                compileOnly name: 'spigot'
            }
        }
    }

    artifacts {
        archives shadowJar
    }
}